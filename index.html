<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç‰§ã€œä¸‹é–¢ æ—…ã®ã—ãŠã‚Š</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --main: #5d9cec; --sub: #48cfad; --warn: #fc6e51; --bg: #f0f2f5; }
        * { box-sizing: border-box; font-family: sans-serif; }
        body { background: var(--bg); margin: 0; padding: 10px; color: #333; font-size: 14px; }
        .container { max-width: 100%; margin-bottom: 50px; }
        
        /* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header-box { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 15px; position: sticky; top: 0; z-index: 100; }
        .total-price { color: var(--warn); font-size: 1.5rem; font-weight: bold; }

        /* ã‚«ãƒ¼ãƒ‰ */
        .day-label { display: block; margin: 15px 0 8px; }
        .day-input { border: none; background: var(--main); color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; }
        .card { background: white; border-radius: 12px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); overflow: hidden; border-left: 6px solid var(--main); }
        
        /* è¦‹å‡ºã— */
        .card-summary { display: flex; align-items: center; padding: 12px 10px; }
        .handle { color: #ccc; margin-right: 8px; font-size: 1.2rem; cursor: move; }
        .t-in { width: 85px; font-weight: bold; color: var(--main); border: 1px solid #eee; border-radius: 4px; padding: 4px; font-size: 0.9rem; }
        .p-in-top { flex-grow: 1; border: none; font-size: 0.95rem; font-weight: 500; min-width: 0; margin-left: 5px; }
        .toggle-btn { color: var(--main); font-size: 0.8rem; font-weight: bold; padding: 5px; margin-left: 5px; }

        /* è©³ç´° */
        .card-detail { display: none; padding: 15px; background: #fafafa; border-top: 1px solid #eee; }
        .card-detail.active { display: block; }

        .nest-box { background: #f0f4f8; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
        .map-btn { display: inline-block; background: #4285F4; color: white; padding: 8px 12px; border-radius: 5px; text-decoration: none; margin-bottom: 10px; font-size: 0.8rem; width: 100%; text-align: center; }
        
        /* è²»ç”¨æ˜ç´° */
        .cost-row { display: flex; gap: 5px; margin-bottom: 5px; align-items: center; }
        .cost-row input { border: 1px solid #ddd; padding: 6px; border-radius: 4px; font-size: 12px; }

        /* ãƒœã‚¿ãƒ³ */
        .btn { border: none; border-radius: 10px; padding: 12px; font-weight: bold; width: 100%; margin-top: 10px; }
        .btn-save { background: var(--main); color: white; }
        .btn-add { background: var(--sub); color: white; }
        .btn-del { background: #ffeded; color: #ff5252; font-size: 0.7rem; border: 1px solid #ff5252; margin-top: 15px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <div style="display:flex; justify-content: space-between; align-items: center;">
            <span>ğŸ’° åˆè¨ˆ: <span id="total-val" class="total-price">0</span> å††</span>
        </div>
        <button class="btn btn-save" onclick="saveAll()">ğŸ’¾ è¨˜éŒ²ã‚’ä¿å­˜ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
        <div id="save-info" style="font-size: 10px; color: #999; text-align: right; margin-top: 5px;"></div>
    </div>

    <div id="main-list">
        <div class="day-label"><input type="date" class="day-input" value="2025-12-29"></div>
        
        <div class="card">
            <div class="card-summary">
                <span class="handle">â˜°</span>
                <input type="time" class="t-in" value="01:30">
                <input class="p-in-top" value="å°ç‰§ å‡ºç™º">
                <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
            </div>
            <div class="card-detail">
                <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
                <div class="nest-box">ğŸš— ç§»å‹•ï¼šæ¬¡ã®åœ°ç‚¹ã¾ã§ ç´„2æ™‚é–“</div>
                <div class="cost-row"><input value="é«˜é€Ÿä»£" style="width:70px"><input type="number" class="price-input" value="10290" oninput="calc()">å††</div>
                <div class="cost-row"><input value="ç‡ƒæ–™ä»£" style="width:70px"><input type="number" class="price-input" value="8000" oninput="calc()">å††</div>
                <button class="btn btn-del" onclick="this.parentElement.parentElement.remove();calc()">ã“ã®é …ç›®ã‚’å‰Šé™¤</button>
            </div>
        </div>

        <div class="card">
            <div class="card-summary">
                <span class="handle">â˜°</span>
                <input type="time" class="t-in" value="03:30">
                <input class="p-in-top" value="å¤§æ´¥SAï¼ˆäº¬éƒ½ï¼‰">
                <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
            </div>
            <div class="card-detail">
                <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
                <div class="nest-box">â±ï¸ æ»åœ¨ï¼š30åˆ†<br>ğŸš— ç§»å‹•ï¼šæ¬¡ã®åœ°ç‚¹ã¾ã§ ç´„2æ™‚é–“</div>
                <div class="cost-row"><input value="ãŠåœŸç”£" style="width:70px"><input type="number" class="price-input" value="2000" oninput="calc()">å††</div>
                <button class="btn btn-del" onclick="this.parentElement.parentElement.remove();calc()">ã“ã®é …ç›®ã‚’å‰Šé™¤</button>
            </div>
        </div>

        <div class="day-label"><input type="date" class="day-input" value="2025-12-30"></div>

        <div class="card">
            <div class="card-summary">
                <span class="handle">â˜°</span>
                <input type="time" class="t-in" value="09:00">
                <input class="p-in-top" value="èµ¤é–“ç¥å®®ãƒ»äº€å±±å…«å¹¡å®®">
                <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
            </div>
            <div class="card-detail">
                <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
                <div class="cost-row"><input value="å¾¡æœ±å°" style="width:70px"><input type="number" class="price-input" value="1000" oninput="calc()">å††</div>
                <button class="btn btn-del" onclick="this.parentElement.parentElement.remove();calc()">ã“ã®é …ç›®ã‚’å‰Šé™¤</button>
            </div>
        </div>
    </div>

    <button class="btn btn-add" onclick="addNewCard()">ï¼‹ æ–°ã—ã„äºˆå®šã‚’è¿½åŠ </button>
</div>

<script>
    // ä¸¦ã³æ›¿ãˆï¼ˆ0.4ç§’é•·æŠ¼ã—ï¼‰
    Sortable.create(document.getElementById('main-list'), {
        handle: '.handle', animation: 150, delay: 400, delayOnTouchOnly: true
    });

    function toggleDetail(btn) {
        const detail = btn.parentElement.nextElementSibling;
        const isActive = detail.classList.contains('active');
        detail.classList.toggle('active');
        btn.innerText = isActive ? 'â–¼ è©³ç´°' : 'â–² é–‰ã˜ã‚‹';
    }

    function openMap(el) {
        const name = el.closest('.card').querySelector('.p-in-top').value;
        window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(name)}`, '_blank');
    }

    function calc() {
        let total = 0;
        document.querySelectorAll('.price-input').forEach(i => total += (parseInt(i.value) || 0));
        document.getElementById('total-val').innerText = total.toLocaleString();
    }

    function addNewCard() {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
            <div class="card-summary">
                <span class="handle">â˜°</span>
                <input type="time" class="t-in" value="12:00">
                <input class="p-in-top" placeholder="æ–°ã—ã„äºˆå®š">
                <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
            </div>
            <div class="card-detail">
                <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
                <div class="cost-row"><input placeholder="è²»ç›®" style="width:70px"><input type="number" class="price-input" value="0" oninput="calc()">å††</div>
                <button class="btn btn-del" onclick="this.parentElement.parentElement.remove();calc()">ã“ã®é …ç›®ã‚’å‰Šé™¤</button>
            </div>
        `;
        document.getElementById('main-list').appendChild(div);
    }

    function saveAll() {
        const data = {
            html: document.getElementById('main-list').innerHTML,
            time: new Date().toLocaleString()
        };
        localStorage.setItem('trip_v3_android', JSON.stringify(data));
        document.getElementById('save-info').innerText = 'ä¿å­˜å®Œäº†: ' + data.time;
        alert('ç¾åœ¨ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨è²»ç”¨ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
    }

    window.onload = () => {
        const saved = localStorage.getItem('trip_v3_android');
        if (saved) {
            const data = JSON.parse(saved);
            document.getElementById('main-list').innerHTML = data.html;
            document.getElementById('save-info').innerText = 'å¾©å…ƒæ¸ˆã¿: ' + data.time;
        }
        calc();
    };
</script>
</body>
</html>

