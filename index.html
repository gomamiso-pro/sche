<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç‰§ã€œä¸‹é–¢ ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ—ãƒ©ãƒ³ã€è©³ç´°ç‰ˆã€‘</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --main: #5d9cec; --sub: #48cfad; --warn: #fc6e51; --bg: #f0f2f5; }
        * { box-sizing: border-box; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); margin: 0; padding: 10px; color: #333; font-size: 14px; }
        
        .box { background: white; padding: 12px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .total-price { color: var(--warn); font-size: 1.4rem; font-weight: bold; }

        input[type="text"], input[type="number"], input[type="time"], input[type="date"] {
            border: 1px solid #ddd; border-radius: 5px; padding: 6px; font-size: 14px; min-width: 0;
        }

        .cost-row { display: flex; gap: 4px; margin-bottom: 6px; align-items: center; width: 100%; }
        .cost-row input[type="text"] { flex: 2; }
        .cost-row input[type="number"] { flex: 1.2; text-align: right; }
        .row-del { color: white; background: #ccc; border: none; border-radius: 50%; width: 22px; height: 22px; font-size: 12px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }

        .day-label { background: var(--main); color: white; padding: 5px 12px; border-radius: 15px; display: inline-block; margin: 10px 0; font-weight: bold; }
        
        /* ç§»å‹•æ™‚é–“ã®è¡¨ç¾ */
        .travel-time { font-size: 11px; color: #888; text-align: center; margin: 5px 0; border-left: 2px dashed #ddd; margin-left: 50px; padding-left: 10px; }

        .card { background: white; border-radius: 10px; margin-bottom: 8px; border-left: 5px solid var(--main); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .card-summary { display: flex; align-items: center; padding: 10px; }
        .handle { color: #ddd; padding-right: 8px; font-size: 1.4rem; touch-action: none; }
        .t-in { width: 85px; }
        .p-in-top { flex-grow: 1; border: none !important; font-weight: bold; margin-left: 5px; font-size: 0.92rem; background: transparent; }
        .toggle-btn { color: var(--main); border: 1px solid var(--main); border-radius: 5px; padding: 4px 8px; font-size: 11px; white-space: nowrap; }

        .card-detail { display: none; padding: 12px; background: #fafafa; border-top: 1px solid #eee; }
        .card-detail.active { display: block; }

        .info-box { background: #eef3f9; padding: 8px; border-radius: 8px; font-size: 11px; margin-bottom: 10px; line-height: 1.4; }
        .map-link { display: inline-block; background: #4285F4; color: white; padding: 6px 12px; border-radius: 5px; text-decoration: none; font-size: 11px; margin-bottom: 10px; font-weight: bold; margin-right: 5px;}

        .btn { border: none; border-radius: 10px; padding: 12px; font-weight: bold; cursor: pointer; width: 100%; }
        .btn-save { background: var(--main); color: white; margin-top: 10px; }
        .btn-add-cost { background: #eee; color: #666; font-size: 12px; padding: 6px; width: auto; margin: 5px 0; border-radius: 5px; display: inline-block; }

        .hist-item { display: flex; justify-content: space-between; background: #e9ecef; padding: 8px; border-radius: 6px; margin-bottom: 5px; font-size: 11px; align-items: center; }
        .btn-restore { background: #666; color: white; padding: 3px 10px; border-radius: 4px; border: none; }
    </style>
</head>
<body>

<div class="box">
    <div style="display:flex; justify-content: space-between; align-items: center;">
        <span style="font-weight:bold">ğŸ’° æ—…ã®åˆè¨ˆ:</span>
        <span class="total-price"><span id="total-val">0</span> å††</span>
    </div>
    
    <div style="margin-top:10px; border-top: 1px solid #eee; padding-top:10px">
        <div style="font-size:11px; color:#666; margin-bottom:5px">â–¼ åˆæœŸè²»ç”¨ï¼ˆé«˜é€Ÿãƒ»ç‡ƒæ–™ãƒ»å®¿æ³Šï¼‰</div>
        <div id="base-costs">
            <div class="cost-row"><input type="text" value="é«˜é€Ÿ(æ·±å¤œå‰²é©ç”¨ç›®å®‰)"><input type="number" class="price-input" value="10290" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
            <div class="cost-row"><input type="text" value="ã‚¬ã‚½ãƒªãƒ³ä»£è¦‹è¾¼ã¿"><input type="number" class="price-input" value="8000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
        </div>
        <button class="btn-add-cost" onclick="addCostRow('base-costs')">ï¼‹ é …ç›®ã‚’è¿½åŠ </button>
    </div>
    <button class="btn btn-save" onclick="saveAll()">ğŸ’¾ å¤‰æ›´ã‚’ä¿å­˜ã—ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
</div>

<div id="main-list">
    <div class="day-label"><input type="date" value="2025-12-29" style="border:none; background:transparent; color:white; font-weight:bold"></div>
    
    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="01:30">
            <input class="p-in-top" value="å°ç‰§å¸‚ å‡ºç™º">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <div class="info-box">04:00ã¾ã§ã«é«˜é€Ÿé“è·¯ã‚’é€šéã™ã‚‹ã¨æ·±å¤œå‰²å¼•(30%OFF)ãŒé©ç”¨ã•ã‚Œã¾ã™ï¼</div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„1æ™‚é–“34åˆ† (129km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="03:30">
            <input class="p-in-top" value="å¤§æ´¥SA (ä¸‹ã‚Š) ç€">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="https://www.w-holdings.co.jp/sapa/02080/" class="map-link" target="_blank">ğŸ”— å…¬å¼ã‚µã‚¤ãƒˆ</a>
            <div class="info-box">ä½æ‰€ï¼šæ»‹è³€çœŒå¤§æ´¥å¸‚æœæ—¥ãŒä¸˜ï¼’ä¸ç›®ï¼˜âˆ’ï¼‘<br>è¦‹ã©ã“ã‚ï¼šçµç¶æ¹–ã‚’ä¸€æœ›ã§ãã‚‹å±•æœ›ãƒ‡ãƒƒã‚­ã€‚äº¬é¢¨ã®ãŠåœŸç”£ãŒå……å®Ÿï¼</div>
            <div class="cost-row"><input type="text" value="è»½é£Ÿãƒ»åœŸç”£"><input type="number" class="price-input" value="1500" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„32åˆ† (43.3km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="05:30">
            <input class="p-in-top" value="å¹ç”°SA (ä¸‹ã‚Š) ç€">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="https://www.w-holdings.co.jp/sapa/02120/" class="map-link" target="_blank">ğŸ”— å…¬å¼ã‚µã‚¤ãƒˆ</a>
            <div class="info-box">ä½æ‰€ï¼šå¤§é˜ªåºœå¹ç”°å¸‚å²¸éƒ¨åŒ—ï¼”ä¸ç›®ï¼˜âˆ’ï¼‘<br>ãƒã‚¤ãƒ³ãƒˆï¼šå¤§é˜ªåç‰©ã®è»½é£Ÿã‚ã‚Šã€‚ã”å½“åœ°ã‚¹ãƒãƒ³ã‚¸ãƒœãƒ–ï¼ˆå¤§é˜ªé™å®šï¼‰ã‚’ãƒã‚§ãƒƒã‚¯ï¼</div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„2æ™‚é–“3åˆ† (174km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="08:00">
            <input class="p-in-top" value="å‰å‚™SA (ä¸‹ã‚Š) ç€">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="http://www.w-holdings.co.jp/sapa/2367.html" class="map-link" target="_blank">ğŸ”— å…¬å¼ã‚µã‚¤ãƒˆ</a>
            <div class="info-box">ä½æ‰€ï¼šå²¡å±±çœŒå²¡å±±å¸‚åŒ—åŒºä»Šå²¡ï¼”ï¼—ï¼–<br>ã‚°ãƒ«ãƒ¡ï¼šå²¡å±±åç‰©ã€Œãˆã³ã‚ã—ã€ã‚„ã€Œæ¸…æ°´ç™½æ¡ƒã‚½ãƒ•ãƒˆã€ã€ãã³ã ã‚“ã”ã€‚</div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„1æ™‚é–“56åˆ† (156km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="10:30">
            <input class="p-in-top" value="åŸçˆ†ãƒ‰ãƒ¼ãƒ  æ•£ç­–/æ˜¼é£Ÿ">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="https://www.city.hiroshima.lg.jp/atomicbomb-peace/index.html" class="map-link" target="_blank">ğŸ”— å…¬å¼ã‚µã‚¤ãƒˆ</a>
            <div class="info-box">ä½æ‰€ï¼šåºƒå³¶çœŒåºƒå³¶å¸‚ä¸­åŒºå¤§æ‰‹ç”ºï¼‘ä¸ç›®ï¼‘âˆ’ï¼‘ï¼<br>é§è»Šå ´ï¼šå¸‚å–¶ä¸­å³¶ç”ºé§è»Šå ´ãªã©ãŒä¾¿åˆ©ã€‚ãŠå¥½ã¿ç„¼ãã‚’å ªèƒ½ã€‚</div>
            <div class="cost-row"><input type="text" value="æ˜¼é£Ÿä»£"><input type="number" class="price-input" value="2000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„23åˆ† (19.9km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="13:30">
            <input class="p-in-top" value="å®®å³¶SA (ä¸‹ã‚Š) ç€">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="http://www.w-holdings.co.jp/sapa/2393.html" class="map-link" target="_blank">ğŸ”— å…¬å¼ã‚µã‚¤ãƒˆ</a>
            <div class="info-box">ä½æ‰€ï¼šåºƒå³¶çœŒå»¿æ—¥å¸‚å¸‚ä¸Šå¹³è‰¯ï¼—ï¼–<br>ãƒã‚¤ãƒ³ãƒˆï¼šã‚‚ã¿ã˜é¥…é ­ãƒãƒ©å£²ã‚Šã€ç‰¡è £ã®ä¸²ç„¼ãã€‚åºƒå³¶é™å®šãƒœãƒ–ã‚’æœç´¢ï¼</div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„2æ™‚é–“7åˆ† (182km)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="16:00">
            <input class="p-in-top" value="ä¸‹é–¢ãƒ›ãƒ†ãƒ« ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <div class="info-box">ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼å¤œã¯å”æˆ¸å¸‚å ´å‘¨è¾ºã¸ã€‚</div>
        </div>
    </div>

    <div class="day-label"><input type="date" value="2025-12-30" style="border:none; background:transparent; color:white; font-weight:bold"></div>
    
    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="09:00">
            <input class="p-in-top" value="ä¸‹é–¢ ç¥ç¤¾å·¡ã‚Š(äº€å±±ãƒ»èµ¤é–“)">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <a href="http://www.kameyamagu.com/" class="map-link" target="_blank">ğŸ”— äº€å±±å…«å¹¡å®®</a>
            <a href="https://akama-jingu.com/" class="map-link" target="_blank">ğŸ”— èµ¤é–“ç¥å®®</a>
            <div class="info-box">èµ¤é–“ç¥å®®ã®é®®ã‚„ã‹ãªæœ±å¡—ã‚Šã®é–€ã¯å¿…è¦‹ã€‚äº€å±±å…«å¹¡å®®ã«ã¯å¤§ããªãƒ•ã‚°ã®åƒãŒã‚ã‚Šã¾ã™ã€‚</div>
        </div>
    </div>

    <div class="travel-time">ğŸš— ç§»å‹•ï¼šç´„1æ™‚é–“ (ä¸‹é–¢å¸‚è¡—ã‚ˆã‚Š)</div>

    <div class="card">
        <div class="card-summary">
            <span class="handle">â˜°</span>
            <input type="time" class="t-in" value="10:30">
            <input class="p-in-top" value="è§’å³¶å¤§æ©‹ ãƒ‰ãƒ©ã‚¤ãƒ–">
            <span class="toggle-btn" onclick="toggleDetail(this)">è©³ç´°</span>
        </div>
        <div class="card-detail">
            <div class="info-box">ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã‚°ãƒªãƒ¼ãƒ³ã®çµ¶æ™¯ï¼æ—¥æœ¬ã®æ©‹ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã§ã‚‚å¸¸ã«ä¸Šä½ã®ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚</div>
        </div>
    </div>
</div>

<div class="box" style="margin-top:20px; background:#f8f9fa">
    <div style="font-weight:bold; font-size:12px; margin-bottom:8px">ğŸ•’ ä¿å­˜å±¥æ­´ï¼ˆå¾©å…ƒç”¨ï¼‰</div>
    <div id="hist-list"></div>
</div>

<script>
    Sortable.create(document.getElementById('main-list'), {
        handle: '.handle', animation: 150, delay: 400, delayOnTouchOnly: true
    });

    function toggleDetail(btn) {
        btn.parentElement.nextElementSibling.classList.toggle('active');
        btn.innerText = btn.innerText === 'è©³ç´°' ? 'é–‰ã˜ã‚‹' : 'è©³ç´°';
    }

    function calc() {
        let t = 0;
        document.querySelectorAll('.price-input').forEach(i => t += (parseInt(i.value) || 0));
        document.getElementById('total-val').innerText = t.toLocaleString();
    }

    function delRow(btn) { btn.parentElement.remove(); calc(); }

    function addCostRow(targetId) {
        const parent = document.getElementById(targetId);
        const div = document.createElement('div');
        div.className = 'cost-row';
        div.innerHTML = `<input type="text" placeholder="é …ç›®å"><input type="number" class="price-input" value="0" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button>`;
        parent.appendChild(div);
    }

    function saveAll() {
        const data = {
            baseHtml: document.getElementById('base-costs').innerHTML,
            listHtml: document.getElementById('main-list').innerHTML,
            time: new Date().toLocaleString()
        };
        let h = JSON.parse(localStorage.getItem('trip_v2_backup') || '[]');
        h.unshift(data);
        localStorage.setItem('trip_v2_backup', JSON.stringify(h.slice(0, 5)));
        renderHist();
        alert('ä¿å­˜ã—ã¾ã—ãŸï¼');
    }

    function renderHist() {
        const h = JSON.parse(localStorage.getItem('trip_v2_backup') || '[]');
        document.getElementById('hist-list').innerHTML = h.map((d, i) => `
            <div class="hist-item">
                <span>${d.time}</span>
                <button class="btn-restore" onclick="restore(${i})">èª­ã¿å‡ºã™</button>
            </div>`).join('');
    }

    function restore(i) {
        const h = JSON.parse(localStorage.getItem('trip_v2_backup') || '[]');
        document.getElementById('base-costs').innerHTML = h[i].baseHtml;
        document.getElementById('main-list').innerHTML = h[i].listHtml;
        calc();
    }

    window.onload = () => {
        const h = JSON.parse(localStorage.getItem('trip_v2_backup') || '[]');
        if (h.length > 0) restore(0); else calc();
        renderHist();
    };
</script>
</body>
</html>
