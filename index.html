<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç‰§ã€œä¸‹é–¢ æ—…ã®ã—ãŠã‚Š</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --main: #5d9cec; --sub: #48cfad; --warn: #fc6e51; --bg: #f0f2f5; }
        * { box-sizing: border-box; font-family: sans-serif; }
        body { background: var(--bg); margin: 0; padding: 10px; color: #333; font-size: 14px; }
        .container { max-width: 100%; margin-bottom: 60px; }
        
        /* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header-box { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 15px; position: sticky; top: 0; z-index: 100; }
        .total-label { font-size: 0.9rem; color: #666; }
        .total-price { color: var(--warn); font-size: 1.6rem; font-weight: bold; }

        /* ã‚«ãƒ¼ãƒ‰ */
        .day-group { margin-top: 20px; }
        .day-input { border: none; background: var(--main); color: white; padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 0.9rem; margin-bottom: 10px; }
        .card { background: white; border-radius: 12px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); overflow: hidden; border-left: 6px solid var(--main); }
        
        /* è¦‹å‡ºã—ï¼ˆã‚µãƒãƒªãƒ¼ï¼‰ */
        .card-summary { display: flex; align-items: center; padding: 12px 10px; position: relative; }
        .handle { color: #ccc; margin-right: 8px; font-size: 1.4rem; padding: 5px; touch-action: none; }
        .t-in { width: 90px; font-weight: bold; color: var(--main); border: 1px solid #eee; border-radius: 6px; padding: 5px; font-size: 0.9rem; background: #fff; }
        .p-in-top { flex-grow: 1; border: none; font-size: 1rem; font-weight: bold; min-width: 0; margin-left: 8px; background: transparent; }
        .toggle-btn { color: var(--main); font-size: 0.8rem; font-weight: bold; padding: 5px; border: 1px solid var(--main); border-radius: 6px; white-space: nowrap; margin-left: 5px; }

        /* è©³ç´°ï¼ˆã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼‰ */
        .card-detail { display: none; padding: 15px; background: #fafafa; border-top: 1px solid #eee; }
        .card-detail.active { display: block; }

        .info-box { background: #eef3f9; padding: 10px; border-radius: 8px; margin-bottom: 10px; font-size: 0.85rem; line-height: 1.4; border-left: 3px solid #ccc; }
        .map-btn { display: block; background: #4285F4; color: white; padding: 10px; border-radius: 8px; text-decoration: none; margin-bottom: 15px; font-size: 0.85rem; text-align: center; font-weight: bold; }
        
        /* è²»ç”¨æ˜ç´°ã‚¹ã‚¿ã‚¤ãƒ« */
        .cost-section { border-top: 1px dashed #ccc; padding-top: 10px; margin-top: 10px; }
        .cost-row { display: flex; gap: 5px; margin-bottom: 8px; align-items: center; }
        .cost-row input[type="text"] { flex: 2; border: 1px solid #ddd; padding: 8px; border-radius: 5px; font-size: 13px; }
        .cost-row input[type="number"] { flex: 1; border: 1px solid #ddd; padding: 8px; border-radius: 5px; font-size: 13px; text-align: right; }
        .row-del { color: #ff5252; background: none; border: none; font-size: 1.2rem; padding: 0 5px; }

        /* å…¨ä½“æ“ä½œãƒœã‚¿ãƒ³ */
        .btn { border: none; border-radius: 12px; padding: 14px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1rem; }
        .btn-save { background: var(--main); color: white; box-shadow: 0 4px 0 #4a89d8; }
        .btn-add { background: var(--sub); color: white; margin-top: 20px; box-shadow: 0 4px 0 #37bc9b; }
        .btn-del-card { background: #fff; color: #ff5252; font-size: 0.8rem; border: 1px solid #ff5252; margin-top: 20px; padding: 8px; }
        .btn-add-cost { background: #eee; color: #666; font-size: 0.75rem; padding: 5px; border-radius: 5px; margin-bottom: 10px; display: inline-block; width: auto; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <div style="display:flex; justify-content: space-between; align-items: center;">
            <span class="total-label">ğŸ’° äºˆç®—åˆè¨ˆ</span>
            <span><span id="total-val" class="total-price">0</span><small> å††</small></span>
        </div>
        <button class="btn btn-save" onclick="saveAll()">ğŸ’¾ ç¾åœ¨ã®æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹</button>
        <div id="save-info" style="font-size: 10px; color: #999; text-align: right; margin-top: 8px;"></div>
    </div>

    <div id="main-list">
        <div class="day-group">
            <input type="date" class="day-input" value="2025-12-29">
            
            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="01:30">
                    <input class="p-in-top" value="å°ç‰§ å‡ºç™º">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã§å ´æ‰€ã‚’ç¢ºèª</a>
                    <div class="info-box">ğŸš— ç§»å‹•ï¼šæ¬¡ã®åœ°ç‚¹ã¾ã§ ç´„2æ™‚é–“<br>æ·±å¤œå‰²å¼•é©ç”¨ã®ãŸã‚ã€04:00ã¾ã§ã«é«˜é€Ÿã¸ï¼</div>
                    <div class="cost-section">
                        <div class="cost-row"><input type="text" value="é«˜é€Ÿä»£(æ·±å¤œå‰²æ›¿)"><input type="number" class="price-input" value="10290" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <div class="cost-row"><input type="text" value="ã‚¬ã‚½ãƒªãƒ³ä»£"><input type="number" class="price-input" value="8000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="03:30">
                    <input class="p-in-top" value="ã€äº¬éƒ½ã€‘å¤§æ´¥SA">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã§å ´æ‰€ã‚’ç¢ºèª</a>
                    <div class="info-box">â±ï¸ æ»åœ¨ï¼š30åˆ†<br>æ¥½ã—ã¿ï¼šçµç¶æ¹–ä¸€æœ›ãƒ‡ãƒƒã‚­ã€‚äº¬é¢¨ãŠæ¼¬ç‰©ã€ç”Ÿå…«ã¤æ©‹ã€‚</div>
                    <div class="cost-section">
                        <div class="cost-row"><input type="text" value="ãŠåœŸç”£ãƒ»è»½é£Ÿ"><input type="number" class="price-input" value="1000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="05:30">
                    <input class="p-in-top" value="ã€å¤§é˜ªã€‘å¹ç”°SA">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã§å ´æ‰€ã‚’ç¢ºèª</a>
                    <div class="info-box">â±ï¸ æ»åœ¨ï¼š30åˆ†<br>æ¥½ã—ã¿ï¼šãŸã“ç„¼ãã€è±šã¾ã‚“ã€‚é™å®šã‚¹ãƒãƒ³ã‚¸ãƒœãƒ–æœç´¢ï¼</div>
                    <div class="cost-section">
                        <div class="cost-row"><input type="text" value="ãŠã‚„ã¤ä»£"><input type="number" class="price-input" value="1000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="10:30">
                    <input class="p-in-top" value="ã€åºƒå³¶ã€‘åŸçˆ†ãƒ‰ãƒ¼ãƒ ">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã§å ´æ‰€ã‚’ç¢ºèª</a>
                    <div class="info-box">â±ï¸ æ»åœ¨ï¼š2æ™‚é–“<br>è¦³å…‰ï¼šçŸ­æ™‚é–“ã®æ•£ç­–ã€‚é§è»Šå ´ã¯ä¸­å³¶ç”ºãŒä¾¿åˆ©ã€‚</div>
                    <div class="cost-section">
                        <div class="cost-row"><input type="text" value="é§è»Šå ´ä»£"><input type="number" class="price-input" value="1000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="15:00">
                    <input class="p-in-top" value="ä¸‹é–¢ãƒ›ãƒ†ãƒ«ç€">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <div class="info-box">ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼å¤œã¯å”æˆ¸å¸‚å ´å‘¨è¾ºã¸ã€‚</div>
                </div>
            </div>
        </div>

        <div class="day-group">
            <input type="date" class="day-input" value="2025-12-30">

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="09:00">
                    <input class="p-in-top" value="ä¸‹é–¢ ç¥ç¤¾å·¡ã‚Š">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <div class="info-box">äº€å±±å…«å¹¡å®®ï¼ˆãƒ•ã‚°åƒï¼‰ã€èµ¤é–“ç¥å®®ï¼ˆç«œå®®é–€ï¼‰ã€‚å¾¡æœ±å°ã¯9:00ã€œã€‚</div>
                    <div class="cost-section">
                        <div class="cost-row"><input type="text" value="å¾¡æœ±å°ä»£"><input type="number" class="price-input" value="1000" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button></div>
                        <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-summary">
                    <span class="handle">â˜°</span>
                    <input type="time" class="t-in" value="10:30">
                    <input class="p-in-top" value="è§’å³¶å¤§æ©‹ è¦³å…‰">
                    <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
                </div>
                <div class="card-detail">
                    <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã§å ´æ‰€ã‚’ç¢ºèª</a>
                    <div class="info-box">ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã‚°ãƒªãƒ¼ãƒ³ã®çµ¶æ™¯ãƒ‰ãƒ©ã‚¤ãƒ–ï¼</div>
                </div>
            </div>
        </div>
    </div>

    <button class="btn btn-add" onclick="addNewCard()">ï¼‹ æ–°ã—ã„äºˆå®šã‚’è¿½åŠ </button>
</div>

<script>
    // ä¸¦ã³æ›¿ãˆ (é•·æŠ¼ã—0.4ç§’)
    Sortable.create(document.getElementById('main-list'), {
        handle: '.handle', animation: 150, delay: 400, delayOnTouchOnly: true
    });

    function toggleDetail(btn) {
        const detail = btn.parentElement.nextElementSibling;
        const isActive = detail.classList.contains('active');
        detail.classList.toggle('active');
        btn.innerText = isActive ? 'â–¼ è©³ç´°' : 'â–² é–‰ã˜ã‚‹';
    }

    function openMap(el) {
        const name = el.closest('.card').querySelector('.p-in-top').value;
        window.open(`https://www.google.com/maps/search/${encodeURIComponent(name)}`, '_blank');
    }

    function calc() {
        let total = 0;
        document.querySelectorAll('.price-input').forEach(i => total += (parseInt(i.value) || 0));
        document.getElementById('total-val').innerText = total.toLocaleString();
    }

    function delRow(btn) { btn.parentElement.remove(); calc(); }

    function addCostRow(btn) {
        const row = document.createElement('div');
        row.className = 'cost-row';
        row.innerHTML = `<input type="text" placeholder="è²»ç›®"><input type="number" class="price-input" value="0" oninput="calc()"><button class="row-del" onclick="delRow(this)">Ã—</button>`;
        btn.before(row);
    }

    function addNewCard() {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
            <div class="card-summary">
                <span class="handle">â˜°</span>
                <input type="time" class="t-in" value="12:00">
                <input class="p-in-top" placeholder="æ–°ã—ã„äºˆå®š">
                <span class="toggle-btn" onclick="toggleDetail(this)">â–¼ è©³ç´°</span>
            </div>
            <div class="card-detail">
                <a href="#" class="map-btn" onclick="openMap(this)">ğŸ—ºï¸ Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
                <div class="cost-section">
                    <button class="btn btn-add-cost" onclick="addCostRow(this)">ï¼‹ æ˜ç´°è¿½åŠ </button>
                </div>
                <button class="btn btn-del-card" onclick="this.parentElement.parentElement.remove();calc()">äºˆå®šã”ã¨å‰Šé™¤</button>
            </div>`;
        document.getElementById('main-list').appendChild(div);
    }

    function saveAll() {
        const data = { html: document.getElementById('main-list').innerHTML, time: new Date().toLocaleString() };
        localStorage.setItem('shiori_v_final', JSON.stringify(data));
        document.getElementById('save-info').innerText = 'ä¿å­˜å®Œäº†: ' + data.time;
        alert('ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨è²»ç”¨ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
    }

    window.onload = () => {
        const saved = localStorage.getItem('shiori_v_final');
        if (saved) {
            const data = JSON.parse(saved);
            document.getElementById('main-list').innerHTML = data.html;
            document.getElementById('save-info').innerText = 'å¾©å…ƒæ¸ˆã¿: ' + data.time;
        }
        calc();
    };
</script>
</body>
</html>
