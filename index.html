<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç‰§ã€œä¸‹é–¢ é«˜æ©Ÿèƒ½ã—ãŠã‚Š</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --main: #5d9cec; --sub: #48cfad; --warn: #fc6e51; --bg: #f0f2f5; }
        * { box-sizing: border-box; font-family: sans-serif; }
        body { background: var(--bg); margin: 0; padding: 10px; font-size: 14px; }
        .box { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 15px; }
        
        /* è²»ç”¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .cost-detail { font-size: 0.8rem; border-top: 1px solid #eee; margin-top: 10px; padding-top: 10px; }
        .cost-item { display: flex; gap: 5px; margin-bottom: 5px; }
        .cost-item input { border: 1px solid #ddd; padding: 4px; border-radius: 4px; }

        /* ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ */
        .day-label { background: var(--main); color: white; padding: 5px 15px; border-radius: 20px; display: inline-block; margin: 10px 0; font-weight: bold; }
        .card { 
            background: white; border-radius: 12px; margin-bottom: 10px; padding: 15px; 
            border-left: 6px solid var(--main); box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .place-name { font-weight: bold; font-size: 1.1rem; flex-grow: 1; border: none; border-bottom: 1px solid #eee; }
        .time-group { display: flex; flex-direction: column; font-size: 0.85rem; color: #666; min-width: 80px; }
        
        /* ç§»å‹•ãƒ»æ»åœ¨ã®ãƒã‚¹ãƒˆè¡¨ç¤º */
        .nest-info { background: #f9f9f9; padding: 8px; border-radius: 8px; margin: 10px 0; font-size: 0.85rem; border-left: 3px dashed #ccc; }
        
        /* ãƒœã‚¿ãƒ³é¡ */
        .map-link { text-decoration: none; font-size: 1.2rem; margin-left: 10px; }
        .btn { border: none; border-radius: 8px; padding: 10px; font-weight: bold; cursor: pointer; width: 100%; }
        .btn-save { background: var(--main); color: white; margin-bottom: 10px; }
        .btn-add { background: var(--sub); color: white; }
        .btn-del { background: #eee; color: #999; width: auto; padding: 2px 8px; font-size: 11px; margin-top: 10px; }
        
        .total-area { text-align: right; font-size: 1.2rem; font-weight: bold; color: var(--warn); }
    </style>
</head>
<body>

<div class="box">
    <div style="display:flex; justify-content: space-between; align-items: center;">
        <span>ğŸ’° åˆè¨ˆè²»ç”¨:</span>
        <span id="total-price" class="total-area">0</span><span>å††</span>
    </div>
    <button class="btn btn-save" onclick="saveData()" style="margin-top:10px">ğŸ’¾ è¨˜éŒ²ã‚’ä¿å­˜ã™ã‚‹</button>
    <div id="history-list" style="font-size: 11px; color: #666; margin-top: 5px;"></div>
</div>

<div id="schedule-list">
    <div class="day-label">12æœˆ29æ—¥</div>
    
    <div class="card">
        <div class="card-header">
            <input class="place-name" value="å°ç‰§ å‡ºç™º">
            <a href="#" class="map-link" onclick="openMap(this)">ğŸ—ºï¸</a>
        </div>
        <div class="time-group">
            <span>ç™º 01:30</span>
        </div>
        <div class="nest-info">
            ğŸš— ç§»å‹•æ™‚é–“: <input type="text" style="width:50px; border:none; background:transparent" value="2æ™‚é–“">
        </div>
        <div class="cost-detail">
            <div class="cost-item">
                <input type="text" placeholder="è²»ç›®" value="é«˜é€Ÿä»£" style="width:60px">
                <input type="number" class="p-in" value="10290" oninput="calc()" style="width:80px">å††
            </div>
            <div class="cost-item">
                <input type="text" placeholder="è²»ç›®" value="ç‡ƒæ–™ä»£" style="width:60px">
                <input type="number" class="p-in" value="8000" oninput="calc()" style="width:80px">å††
            </div>
        </div>
        <button class="btn-del" onclick="this.parentElement.remove();calc()">å‰Šé™¤</button>
    </div>

    <div class="card">
        <div class="card-header">
            <input class="place-name" value="å¤§æ´¥SAï¼ˆäº¬éƒ½ï¼‰">
            <a href="#" class="map-link" onclick="openMap(this)">ğŸ—ºï¸</a>
        </div>
        <div class="time-group">
            <span>ç€ 03:30</span>
            <span>ç™º 04:00</span>
        </div>
        <div class="nest-info">
            â±ï¸ æ»åœ¨æ™‚é–“: 30åˆ†<br>
            ğŸš— æ¬¡ã¸ã®ç§»å‹•: 1.5æ™‚é–“
        </div>
        <div class="cost-detail">
            <div class="cost-item">
                <input type="text" placeholder="è²»ç›®" value="ãŠåœŸç”£" style="width:60px">
                <input type="number" class="p-in" value="2000" oninput="calc()" style="width:80px">å††
            </div>
        </div>
        <button class="btn-del" onclick="this.parentElement.remove();calc()">å‰Šé™¤</button>
    </div>
    
    </div>

<button class="btn btn-add" onclick="addCard()">ï¼‹ ç«‹ã¡å¯„ã‚Šå…ˆã‚’è¿½åŠ </button>

<script>
    // ä¸¦ã³æ›¿ãˆæ©Ÿèƒ½
    Sortable.create(document.getElementById('schedule-list'), {
        animation: 150, delay: 500, delayOnTouchOnly: true
    });

    // Googleãƒãƒƒãƒ—æ¤œç´¢ã‚’é–‹ã
    function openMap(el) {
        const name = el.parentElement.querySelector('.place-name').value;
        window.open(`https://www.google.com/maps/search/${encodeURIComponent(name)}`, '_blank');
    }

    // è²»ç”¨è¨ˆç®—
    function calc() {
        let total = 0;
        document.querySelectorAll('.p-in').forEach(i => total += (parseInt(i.value) || 0));
        document.getElementById('total-price').innerText = total.toLocaleString();
    }

    // æ–°ã—ã„ã‚«ãƒ¼ãƒ‰è¿½åŠ 
    function addCard() {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
            <div class="card-header">
                <input class="place-name" placeholder="å ´æ‰€åã‚’å…¥åŠ›">
                <a href="#" class="map-link" onclick="openMap(this)">ğŸ—ºï¸</a>
            </div>
            <div class="time-group">
                <span>ç€ <input type="text" value="00:00" style="width:40px; border:none"></span>
                <span>ç™º <input type="text" value="00:00" style="width:40px; border:none"></span>
            </div>
            <div class="nest-info">â±ï¸ æ»åœ¨/ç§»å‹•ã‚’å…¥åŠ›</div>
            <div class="cost-detail">
                <div class="cost-item">
                    <input type="text" placeholder="è²»ç›®" style="width:60px">
                    <input type="number" class="p-in" value="0" oninput="calc()" style="width:80px">å††
                </div>
            </div>
            <button class="btn-del" onclick="this.parentElement.remove();calc()">å‰Šé™¤</button>
        `;
        document.getElementById('schedule-list').appendChild(div);
        calc();
    }

    // ä¿å­˜ã¨å¾©å…ƒ
    function saveData() {
        const data = {
            html: document.getElementById('schedule-list').innerHTML,
            time: new Date().toLocaleTimeString()
        };
        localStorage.setItem('travel_pro_save', JSON.stringify(data));
        renderHistory();
        alert('ä¿å­˜ã—ã¾ã—ãŸï¼');
    }

    function renderHistory() {
        const saved = JSON.parse(localStorage.getItem('travel_pro_save'));
        if(saved) {
            document.getElementById('history-list').innerHTML = 
                `æœ€çµ‚ä¿å­˜: ${saved.time} <button onclick="restoreData()" style="font-size:10px">å¾©å…ƒ</button>`;
        }
    }

    function restoreData() {
        const saved = JSON.parse(localStorage.getItem('travel_pro_save'));
        if(saved) {
            document.getElementById('schedule-list').innerHTML = saved.html;
            calc();
        }
    }

    window.onload = () => { calc(); renderHistory(); };
</script>
</body>
</html>
